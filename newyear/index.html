<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="spm-id" content="a21bo">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>摇出你自己的新年签</title>
    <link rel="stylesheet" href="css/index.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/index.js"></script>
    <script type="text/javascript">
//      var  nickname=getQueryString("nickname");
//      
//      
//      
//      var  headpic = getQueryString("headpic");
//      
//     
//      function getQueryString(str2) {
//          
//          var str = location.href;
//          
//          var arr = str.split(str2);
//        
//          return arr[1]==null? null : arr[1].substring(1,arr[1].length);
//      }
//  var p = null;
//		var iLast = 2,
//			MAX = 50;
//		var t = null;
//  	if(window.plus) {
//			plusReady();
//		} else {
//			document.addEventListener("plusready", plusReady, false);
//		}
// 
//		function plusReady() {
//			// 锁定只能竖屏显示
//			plus.screen.lockOrientation("portrait-primary");
//			plus.accelerometer.watchAcceleration(function(a) {
//				if(!p&&(Math.abs(a.xAxis) + Math.abs(a.yAxis) + Math.abs(a.zAxis) > MAX)) {
//					p = plus.audio.createPlayer("_www/audio/shake.wav");
//					p.play();
//					setTimeout(function() {
//						location.href="shake.html?id=1";
//					}, 2000);
//				}
//			}, function(e) {
//				alert( "Watch failed: "+e.message );
//			}, {
//				frequency: 100
//			})
//		}
 		var SHAKE_THRESHOLD = 3000;  
        var last_update = 0;  
        var x = y = z = last_x = last_y = last_z = 0; 
        init();
        function init() {  
            if (window.DeviceMotionEvent) {  
                window.addEventListener('devicemotion', deviceMotionHandler, false);  
            } else {  
                alert('not support mobile event');  
            }  
        }  
        function deviceMotionHandler(eventData) {  
            var acceleration = eventData.accelerationIncludingGravity;  
            var curTime = new Date().getTime();  
            if ((curTime - last_update) > 50) {  
                var diffTime = curTime - last_update;  
                last_update = curTime;  
                x = acceleration.x;  
                y = acceleration.y;  
                z = acceleration.z;  
                var speed = Math.abs(x + y + z - last_x - last_y - last_z) / diffTime * 10000;  
  
                if (speed > SHAKE_THRESHOLD) {  
			alert("震动哈哈哈")
//                     p = plus.audio.createPlayer("_www/audio/shake.wav");
// 					p.play();
					setTimeout(function() {
						location.href="shake.html?id=1";
					}, 2000);   
                }  
                last_x = x;  
                last_y = y;  
                last_z = z;  
            }  
        }  

    </script>
    
</head>
<body>
    <div class="header">
        <div class="headerBox">
            <div class="photo">
                <img src="" id = "headpic"/>
            </div>
            <div class="nicheng">
            	<span class="name" id = "nickname"></span>
            	<span class="news">的新年签</span>
            </div>
        </div>
    </div>
    <div class="box"><img src="img/index.png" alt=""/></div>
</body>
</html>
